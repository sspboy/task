/// <reference types="node" />
/// <reference path="../color.d.ts" />

declare module 'ui' {

  declare const android: typeof globalAndroid;
  declare const AndroidActivity: (typeof android.app.Activity);
  export interface StatusBarConfig {
    readonly color: Color | string | number;
    readonly light?: boolean;
  }
  export declare class Activity extends AndroidActivity {
    protected insetsController: JavaObject;
    constructor();
    onCreate(savedInstanceState?: android.os.Bundle): void;
    protected get layoutXml(): string | null;
    protected get layoutXmlFile(): string | null;
    protected get initialStatusBar(): StatusBarConfig | null;
    protected onContentViewSet(contentView: android.view.View): void;
    private _setContentView;
    get contentView(): android.view.View;
  }
  export declare type ActivityClass<T extends Activity> = {
    new(): T;
  };
  export declare function setMainActivity<T extends Activity>(activityClass: ActivityClass<T>): void;
  export interface ActivityLifecycle extends EventEmitter {
    on(event: "activity_created", listener: (activity: android.app.Activity, savedInstanceState?: android.os.Bundle) => void): this;
    on(event: "activity_started", listener: (activity: android.app.Activity) => void): this;
    on(event: "activity_resumed", listener: (activity: android.app.Activity) => void): this;
    on(event: "activity_paused", listener: (activity: android.app.Activity) => void): this;
    on(event: "activity_stopped", listener: (activity: android.app.Activity) => void): this;
    on(event: "activity_save_instance_state", listener: (activity: android.app.Activity, outState: android.os.Bundle) => void): this;
    on(event: "activity_destroyed", listener: (activity: android.app.Activity) => void): this;
    on(event: "all_activities_destroyed", listener: () => void): this;
  }
  export declare const activityLifecycle: ActivityLifecycle;
  export declare function startActivity<T extends Activity>(activityClass: ActivityClass<T>, options?: app.IntentOptions): void;
  export { };


  export interface Point {
    readonly x: number;
    readonly y: number;
  }
  /**
   * @中文
   *
   * 大小填满父布局/窗口
   *
   * @eng
   *
   *  MATCH_PARENT means that the view wants to be as big as its parent, minus the parent's padding, if any.
   */
  export declare const MATCH_PARENT = -1;
  /**
   * @中文
   *
   * 自适应大小。
   *
   * @eng
   *
   * WRAP_CONTENT means that the view wants to be just large enough to fit its own internal content, taking its own padding into account.
   */
  export declare const WRAP_CONTENT = -2;
  /**
   * 表示大小的对象，单位一般为像素。另外，当值为{@link WRAP_CONTENT}时，表示自适应大小；当值为{@link MATCH_PARENT}时，表示大小填满父布局/窗口。
   */
  export interface Size {
    readonly width: number;
    readonly height: number;
  }


  declare type Context = android.content.Context;
  declare type ViewGroup = android.view.ViewGroup;
  declare type View = android.view.View;
  export interface Resources {
    [type: string]: Resource;
  }
  export interface Resource {
    [name: string]: number;
  }
  /**
   * @中文
   *
   * 类似于Android中的R，用于获取资源相关的ID，比如`R.drawable.ic_launcher`，`R.style.ScriptTheme`等。
   *
   * @eng
   *
   * Similar to Android's R, used to get resource related ID, such as `R.drawable.ic_launcher` and `R.style.ScriptTheme`.
   *
   * @example
   * ```javascript
   * "nodejs";
   *
   * const { R } = require("ui");
   *
   * const context = $autojs.androidContext;
   * console.log(context.getDrawable(R.drawable.ic_delete))
   *
   * ```
   * @see https://developer.android.com/reference/android/R
   */
  export declare const R: Resources;
  /**
   * @中文
   *
   * 解析xm内容并创建其对应的View树。若解析失败则抛出[InflateException](https://developer.android.com/reference/android/view/InflateException)异常。
   *
   * @param ctx Android [Context](https://developer.android.com/reference/android/content/Context)对象，若要创建androidx相关的View，则必须指定Material相关主题的Context
   * @param xml xml内容
   * @param parent 若attachToRoot为false，则指定parent为新创建的View的父View；若attachToRoot为false，则parent为解析xml过程中用于生成LayoutParams的View。默认为null。
   * @param attachToParent 创建新View后是否添加到parent中，默认为false
   * @returns
   *
   * @eng
   *
   * Inflate a new view hierarchy from the specified xml resource. Throws InflateException if there is an error.
   *
   * @param ctx Android [Context](https://developer.android.com/reference/android/content/Context), if you want to create androidx-related views, you must specify a Material-related theme context
   * @param xml xml content
   * @param parent Optional view to be the parent of the generated hierarchy (if attachToRoot is true), or else simply an object that provides a set of LayoutParams values for root of the returned hierarchy (if attachToRoot is false.)
   * @param Whether the inflated hierarchy should be attached to the root parameter? If false, root is only used to create the correct subclass of LayoutParams for the root view in the XML.
   */
  export declare function inflateXml(ctx: Context, xml: string, parent?: ViewGroup, attachToParent?: boolean): JsView<View>;
  /**
   * @中文
   *
   * 获取默认主题的Context。
   *
   * @eng
   *
   * Get the default theme context.
   */
  export declare function defaultThemeContext(): Context;
  export { };

  /**
   * @中文
   *
   * 判断当前线程是否是UI线程
   *
   * @returns 是否是UI线程
   *
   * @eng
   *
   * Whether the current thread is UI thread
   *
   * @returns Whether the current thread is UI thread
   */
  export declare function isUiThread(): boolean;


  declare type View = android.view.View;
  export declare type JsView<T extends View> = T & JsViewExt<T>;
  export interface JsViewExt<T> extends EventEmitter {
    findView<T extends View>(id: string): JsView<T> | null;
    attr(attrName: string): string | null | undefined;
    attr(attrName: string, value: string | null): void;
  }
  export interface ViewEvent {
    consumed: boolean;
    view: View;
  }
  export { };

  export interface WebActivityArgs {
    readonly initialUrl?: string;
    readonly title?: string;
    readonly statusBarColor?: string;
    readonly intentFlags?: number;
  }
  export interface IPCEvent {
    readonly name: string;
  }
  export interface InvokeEvent {
    readonly channel: string;
    readonly arguments: Array<any>;
  }
  export declare type InvokeRequestHandler = (event: InvokeEvent, ...args: any) => any | Promise<any>;
  export interface JavaScriptBridge extends EventEmitter {
    eval(code: string): Promise<any>;
    handle(action: string | null | undefined, handler: InvokeRequestHandler): this;
    invoke(channel: string, ...args: any): Promise<any>;
    send(event: string, ...args: any): void;
    on(event: string, listener: ((event: IPCEvent, ...args: any) => void)): this;
  }
  export interface JsWebView extends android.webkit.WebView {
    readonly jsBridge: JavaScriptBridge;
    addListener(event: string | symbol, listener: (...args: any[]) => void): this;
    on(event: string | symbol, listener: (...args: any[]) => void): this;
    once(event: string | symbol, listener: (...args: any[]) => void): this;
    removeListener(event: string | symbol, listener: (...args: any[]) => void): this;
    off(event: string | symbol, listener: (...args: any[]) => void): this;
    removeAllListeners(event?: string | symbol): this;
    setMaxListeners(n: number): this;
    getMaxListeners(): number;
    listeners(event: string | symbol): Function[];
    rawListeners(event: string | symbol): Function[];
    emit(event: string | symbol, ...args: any[]): boolean;
    listenerCount(event: string | symbol): number;
    prependListener(event: string | symbol, listener: (...args: any[]) => void): this;
    prependOnceListener(event: string | symbol, listener: (...args: any[]) => void): this;
    eventNames(): Array<string | symbol>;
  }
}
